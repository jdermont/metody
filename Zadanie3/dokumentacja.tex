%& --translate-file=cp1250pl
\documentclass[12pt,a4paper]{article}
\usepackage[left=0.75in,right=0.75in,top=0.75in,bottom=0.75in,dvips]{geometry}


\usepackage{polski}
\usepackage[OT4]{fontenc}
\usepackage{amsthm,amsmath,amsfonts,amssymb}

\usepackage{verbatim}

\usepackage{graphicx}
\usepackage{color}
\usepackage{alltt}
\usepackage{enumerate}
\usepackage{url}
\usepackage{listings}
\lstset{language=C++,
tabsize=1,
basicstyle=\ttfamily\footnotesize,
frame=shadowbox,
breaklines=true,
showstringspaces=false}

\author{Marcin Horoszko, Rados³aw G³ombiowski, Jacek Dermont}
\title{Dokumentacja do zadania 3.14}

\newtheorem{tw}{Czêœæ}[section]
\theoremstyle{definition}
\newtheorem{defi}[tw]{}

\begin{document}

\maketitle

\section{Zadanie 3.14}
Zagadnienie ró¿niczkowe $xy' = (y - 2)y - x^4, y(1) = 3$ rozwi¹zaæ na przedziale $[1,3]$ metod¹ Eulera oraz udoskonalon¹ metod¹ Eulera, zwan¹ metod¹ Heuna.
Wyniki porównaæ z rozwi¹zaniem dok³adnym $y(x) = x^2 + 2$.

\section{Podstawowe pojêcia}
\begin{defi}[Równanie ró¿niczkowe]
Równanie wyznaczaj¹ce zale¿noœæ miêdzy nieznan¹ funkcj¹ a jej pochodnymi. Polega na znalezieniu funkcji $y$, która spe³nia to równanie. Na przyk³ad równanie ró¿niczkowe
$y'' + y = 0$  ma ogólne rozwi¹zanie w postaci $y = Acosx+Bsinx$, gdzie $A$ i $B$ s¹ sta³ymi wyznaczonymi z warunków brzegowych.
\end{defi}
\begin{defi}[Zagadnienie Cauchy'ego]
Zagadnienie polegaj¹ce na znalezieniu konkretnej funkcji spe³niaj¹cej dane równanie ró¿niczkowe i warunek pocz¹tkowy. W przypadku równania stopnia
pierwszego, warunkiem pocz¹tkowym bêdzie punkt, przez który powinien przechodziæ wykres szukanej funkcji. W przypadku równania stopnia drugiego, zagadnienie
pocz¹tkowe zawieraæ bêdzie dodatkowo wartoœæ pierwszej pochodnej w danym punkcie i analogicznie, w przypadku równañ wy¿szego stopnia. \\ \\
$\mathbf{Przyk³ad:}$ \\
$ \left\{\begin{array}{ccc} y' = \frac{y}{x^2+1} \\ y(\frac{\pi}{4}) = e^3 \\ \end{array}\right.
\Longrightarrow y=e^{arctgx+C} \Longrightarrow \left.\begin{array}{ccc} e^3 = e^{arctg\frac{\pi}{4}+C} \\ C = 3 - arctg\frac{\pi}{4} \\ \end{array}\right.
\Longrightarrow y = e^{arctgx+3-arctg\frac{\pi}{4}}$ \\ \\
A wiêc rozwi¹zanie to $y = e^{arctgx+3-arctg\frac{\pi}{4}}$.
\end{defi}
\begin{defi}[Metoda Eulera]
Sposób rozwi¹zywania równañ ró¿niczkowych.\\ Na wejœciu mamy równanie $y'=f(x,y)$ o warunkach pocz¹tkowych $(x_0,y_0) = y(x_0)$ oraz ustalone $h$ (zatem kolejne
punkty $x$ wyznaczamy tak: $x_{n+1} = x_n + h$). \\ Z definicji pochodnej: $y' = \frac{\Delta y}{h}$, czyli $f(x_n,y_n) = \frac{\Delta y}{h}$. Po przekszta³ceniu: 
$\Delta y = hf(x_n,y_n)$ \\
Szukamy $y_{n+1} = y + \Delta y$. Po przekszta³ceniu mamy wzór: $\mathbf{y_{n+1} = y_n + hf(x_n,y_n)}$. \\
Wykorzystujemy ten wzór to przybli¿ania wartoœci punktów. Zale¿nie od $h$, przybli¿enie bêdzie siê ró¿ni³o od dok³adnego wyniku. Im mniejsze $h$, tym mniejszy b³¹d.
\end{defi}
\begin{defi}[Udoskonalona metoda Eulera - metoda Heuna]
Modyfikacja metody Eulera. Obliczamy $\Delta y$ za pomoc¹:
$\mathbf{\Delta y = h\frac{f(x_n,y_n)+f(x_n+h,y_n+f(x_n,y_n)h)}{2}}$
\end{defi}
\ \\ \ \\
\section{Analiza przyk³adu}
Dla du¿ych kroków $h$ b³¹d jest wzglêdnie du¿y. Jak siê okazuje, w tym przypadku krok $h = 0.1$ jest ``bardzo du¿y''. \\
\includegraphics[width=168mm]{h01_out.png} \\ \\ \\
Ju¿ jest lepiej dla kroku $h = 0.001$, jednak funkcja staje siê wyraŸnie rozbie¿na w po³owie przedzia³u. \\
\includegraphics[width=168mm]{h0001_out.png} \\ \\ \\ \\ \\ \\ \\
Krok $h$, co najwy¿ej $h = 0.00001$, wybrany doœwiadczalnie. Tutaj Metoda Eulera ju¿ mocno zbli¿a siê do równania dok³adnego,
jednak wci¹¿ nie jest idealnie. \\
\includegraphics[width=168mm]{h000001_out.png} \\
Zatem wiêkszych kroków $h > 0.00001$ nie ma sensu wybieraæ.
\section{Metoda numeryczna}
U¿ytkownik pytany jest o krok $h$ z zakresu $(0,1)$. G³ówna czêœæ metody opiera siê na trzech pêtlach, ka¿da oblicza wartoœci: dok³adnym równaniem, metod¹ Eulera
i metod¹ Heuna.
\begin{itemize}
\item przedzia³ $[1,3]$ jest d³ugoœci 2, wiêc ka¿da pêtla ma ok. $\frac{2}{h}+1$ iteracji
\item $y_0$ = 3
\item $y_{n+1}$ jest obliczane zgodnie ze wzorem danej metody
\item tylko co któreœ $y_n$ jest drukowane na wyjœcie (by by³o maksymalnie 21 wartoœci na ekranie)
\item na wyjœciu drukowany jest tak¿e b³¹d bezwglêdny wzglêdem rozwi¹zania dok³adnego
\end{itemize}
\end{document}